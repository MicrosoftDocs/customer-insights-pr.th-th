---
title: เชื่อมต่อกับโฟลเดอร์ Common Data Model โดยใช้บัญชี Azure Data Lake
description: ทำงานกับข้อมูล Common Data Model โดยใช้ Azure Data Lake Storage
ms.date: 09/29/2022
ms.topic: how-to
author: mukeshpo
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- ci-attach-cdm
- customerInsights
ms.openlocfilehash: c12603b9ed8a814356a0f8d0137e97afc749b87c
ms.sourcegitcommit: be341cb69329e507f527409ac4636c18742777d2
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 09/30/2022
ms.locfileid: "9609971"
---
# <a name="connect-to-data-in-azure-data-lake-storage"></a>เชื่อมต่อกับข้อมูลใน Azure Data Lake Storage

นำข้อมูลเข้ามาใน Dynamics 365 Customer Insights โดยใช้บัญชี Azure Data Lake Storage รุ่น2 ของคุณ การนำเข้าข้อมูลอาจเป็นแบบทั้งหมดหรือแบบเพิ่มหน่วยก็ได้

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

- การนำเข้าข้อมูลรองรับบัญชี Azure Data Lake Storage *รุ่น2* เท่านั้น คุณไม่สามารถใช้บัญชี Data Lake Storage รุ่น1 เพื่อนำเข้าข้อมูล

- บัญชี Azure Data Lake Storage ต้องมีการ [เปิดใช้งานเนมสเปซตามลำดับชั้น](/azure/storage/blobs/data-lake-storage-namespace) ข้อมูลต้องจัดเก็บในรูปแบบโฟลเดอร์ตามลำดับชั้นที่กำหนดโฟลเดอร์รากและมีโฟลเดอร์ย่อยสำหรับแต่ละเอนทิตี โฟลเดอร์ย่อยสามารถมีโฟลเดอร์ข้อมูลทั้งหมดหรือโฟลเดอร์แบบเพิ่มหน่วย

- การตรวจสอบสิทธิ์กับบริการหลักของ Azure ตรวจสอบให้แน่ใจว่าได้กำหนดค่าไว้ในผู้เช่าของคุณ สำหรับข้อมูลเพิ่มเติม โปรดดู [เชื่อมต่อกับบัญชี Azure Data Lake Storage รุ่น2 ด้วยบริการหลักของ Azure](connect-service-principal.md)

- Azure Data Lake Storage ที่คุณต้องการเชื่อมต่อและนำเข้าข้อมูลจากต้องอยู่ในภูมิภาค Azure เดียวกันกับสภาพแวดล้อม Dynamics 365 Customer Insights ไม่รองรับการเชื่อมต่อกับโฟลเดอร์ Common Data Model จากที่จัดเก็บข้อมูลดิบในภูมิภาค Azure อื่นๆ หากต้องการทราบภูมิภาค Azure ของสภาพแวดล้อม ไปที่ **ผู้ดูแลระบบ** > **ระบบ** > **เกี่ยวกับ** ใน Customer Insights

- ข้อมูลที่จัดเก็บในบริการออนไลน์อาจถูกจัดเก็บในตำแหน่งอื่นนอกเหนือจากที่ข้อมูลถูกประมวลผลหรือจัดเก็บใน Dynamics 365 Customer Insights การนำเข้าหรือการเชื่อมต่อไปยังข้อมูลที่จัดเก็บในบริการออนไลน์ หมายถึงคุณยอมรับว่าสามารถถ่ายโอนข้อมูลและจัดเก็บด้วย Dynamics 365 Customer Insights [เรียนรู้เพิ่มเติมที่ Microsoft Trust Center](https://www.microsoft.com/trust-center)

- บริการหลักของ Customer Insights ต้องมีบทบาทใดบทบาทหนึ่งต่อไปนี้เพื่อเข้าถึงบัญชีที่เก็บข้อมูล สำหรับข้อมูลเพิ่มเติม โปรดดู [ให้สิทธิ์แก่บริการหลักในการเข้าถึงบัญชีที่เก็บข้อมูล](connect-service-principal.md#grant-permissions-to-the-service-principal-to-access-the-storage-account)
  - ตัวอ่าน Storage Blob Data
  - เจ้าของ Storage Blob Data
  - ผู้สนับสนุน Storage Blob Data

- ผู้ใช้ที่ตั้งค่าการเชื่อมต่อแหล่งข้อมูล ต้องการสิทธิ์อย่างน้อย Storage Blob Data Contributor ในบัญชีที่เก็บข้อมูล

- ข้อมูลใน Data Lake Storage ของคุณควรเป็นไปตามมาตรฐาน Common Data Model สำหรับการจัดเก็บข้อมูลของคุณ และมีไฟล์กำกับ Common Data Model เพื่อแสดง Schema ของไฟล์ข้อมูล (*.csv หรือ *.parquet) ไฟล์กำกับต้องให้รายละเอียดของเอนทิตี เช่น คอลัมน์เอนทิตีและชนิดข้อมูล และตำแหน่งไฟล์ข้อมูลและชนิดไฟล์ สำหรับข้อมูลเพิ่มเติม โปรดดู [ไฟล์กำกับ Common Data Model](/common-data-model/sdk/manifest) หากไม่มีไฟล์กำกับ ผู้ใช้ที่เป็นผู้ดูแลระบบที่มีสิทธิ์เข้าถึงในฐานะเจ้าของข้อมูลในที่เก็บข้อมูล Blob หรือผู้สนับสนุนข้อมูลในที่เก็บข้อมูล Blob สามารถกำหนด Schema เมื่อนำเข้าข้อมูลได้

## <a name="recommendations"></a>การแนะนำ

เพื่อประสิทธิภาพสูงสุด Customer Insights แนะนำให้ขนาดของพาร์ติชั่นไม่เกิน 1 GB และจำนวนไฟล์พาร์ติชั่นในโฟลเดอร์ต้องไม่เกิน 1,000

## <a name="connect-to-azure-data-lake-storage"></a>เชื่อมต่อกับ Azure Data Lake Storage

1. ไปที่ **ข้อมูล** > **แหล่งข้อมูล**

1. เลือก **เพิ่มแหล่งข้อมูล**

1. เลือก **Azure Data Lake Storage**

   :::image type="content" source="media/data_sources_ADLS.png" alt-text="กล่องโต้ตอบเพื่อป้อนรายละเอียดการเชื่อมต่อสำหรับ Azure Data Lake" lightbox="media/data_sources_ADLS.png":::

1. ป้อน **ชื่อ** สำหรับแหล่งข้อมูลและ **คำอธิบาย** ที่ระบุหรือไม่ก็ได้ ชื่อนี้จะระบุแหล่งข้อมูลที่ไม่ซ้ำกันและมีการอ้างอิงในกระบวนการดาวน์สตรีมและไม่สามารถเปลี่ยนแปลงได้

1. เลือกหนึ่งในตัวเลือกต่อไปนี้สำหรับ **เชื่อมต่อที่เก็บข้อมูลของคุณโดยใช้** สำหรับข้อมูลเพิ่มเติม โปรดดู [เชื่อมต่อ Customer Insights กับบัญชี Azure Data Lake Storage รุ่น2 ด้วยบริการหลักของ Azure](connect-service-principal.md)

   - **ทรัพยากร Azure**: ป้อน **รหัสทรัพยากร** หรือถ้าคุณต้องการนำเข้าข้อมูลจากบัญชีที่เก็บข้อมูลผ่าน Azure Private Link ให้เลือก **เปิดใช้งานลิงก์ส่วนตัว** สำหรับข้อมูลเพิ่มเติม โปรดดู [Private Link](security-overview.md#set-up-an-azure-private-link)
   - **การสมัครใช้งาน Azure**: เลือก **การสมัครใช้งาน** แล้วเลือก **กลุ่มทรัพยากร** และ **บัญชีที่เก็บข้อมูล** หรือถ้าคุณต้องการนำเข้าข้อมูลจากบัญชีที่เก็บข้อมูลผ่าน Azure Private Link ให้เลือก **เปิดใช้งาน Private Link** สำหรับข้อมูลเพิ่มเติม โปรดดู [Private Link](security-overview.md#set-up-an-azure-private-link)
  
   > [!NOTE]
   > คุณต้องมีบทบาทใดบทบาทหนึ่งต่อไปนี้กับคอนเทนเนอร์หรือบัญชีที่เก็บข้อมูลเพื่อสร้างแหล่งข้อมูล:
   >
   >  - ผู้อ่านข้อมูลของ Blob ในที่เก็บข้อมูลเพียงพอที่จะอ่านจากบัญชีที่เก็บข้อมูลและนำเข้าข้อมูลไปยัง Customer Insights
   >  - ผู้สนับสนุนข้อมูลของ Blob ในที่เก็บข้อมูลหรือเจ้าของเป็นสิ่งจำเป็น หากคุณต้องการแก้ไขไฟล์กำกับโดยตรงใน Customer Insights  
  
1. เลือกชื่อของ **คอนเทนเนอร์** ที่มีข้อมูลและ Schema (ไฟล์ model.json หรือ manifest.json) ที่จะใช้นำเข้าข้อมูล และเลือก **ถัดไป**
   > [!NOTE]
   > ไฟล์ model.json หรือ manifest.json ใดๆ ที่เชื่อมโยงกับแหล่งข้อมูลอื่นในสภาพแวดล้อม จะไม่แสดงในรายการ อย่างไรก็ตาม ไฟล์ model.json หรือ manifest.json เดียวกัน สามารถใช้สำหรับแหล่งข้อมูลในหลายสภาพแวดล้อม

1. หากต้องการสร้าง Schema ใหม่ ให้ไปที่ [สร้างไฟล์ Schema ใหม่](#create-a-new-schema-file)

1. หากต้องการใช้ Schema ที่มีอยู่ ให้ไปที่โฟลเดอร์ที่มีไฟล์ model.json หรือ manifest.cdm.json คุณสามารถค้นหาภายในไดเรกทอรีเพื่อค้นหาไฟล์

1. เลือกไฟล์ json และเลือก **ถัดไป** รายการของเอนทิตีที่มีอยู่จะแสดง

   :::image type="content" source="media/review-entities.png" alt-text="กล่องโต้ตอบของรายการเอนทิตีที่จะเลือก":::

1. เลือกเอนทิตีที่คุณต้องการรวม

   :::image type="content" source="media/ADLS_required.png" alt-text="กล่องโต้ตอบที่แสดง ต้องการสำหรับคีย์หลัก":::

   > [!TIP]
   > หากต้องการแก้ไขเอนทิตีในส่วนติดต่อการแก้ไข JSON ให้เลือกเอนทิตี แล้วเลือก **แก้ไขไฟล์ Schema** ทำการเปลี่ยนแปลงและเลือก **บันทึก**

1. สำหรับเอนทิตีที่เลือกซึ่งต้องมีการนำเข้าแบบเพิ่มหน่วย **จำเป็น** จะแสดงภายใต้ **การรีเฟรชแบบเพิ่มหน่วย** สำหรับแต่ละเอนทิตีเหล่านี้ ดูที่ [กำหนดค่าการรีเฟรชแบบเพิ่มหน่วยสำหรับแหล่งข้อมูล Azure Data Lake](incremental-refresh-data-sources.md)

1. สำหรับเอนทิตีที่เลือกซึ่งไม่ได้กำหนดคีย์หลัก **จำเป็น** จะแสดงภายใต้ **คีย์หลัก** สำหรับแต่ละเอนทิตีเหล่านี้:
   1. เลือก **จำเป็น** แผง **แก้ไขเอนทิตี** จะแสดง
   1. เลือก **คีย์หลัก** คีย์หลักคือแอตทริบิวต์ที่ไม่ซ้ำกับเอนทิตี เพื่อให้แอตทริบิวต์เป็นคีย์หลักที่ถูกต้อง ไม่ควรมีค่าที่ซ้ำกัน ค่าที่ขาดหายไป หรือค่า null แอตทริบิวต์ชนิดข้อมูลสตริง จำนวนเต็ม และ GUID ได้รับการสนับสนุนเป็นคีย์หลัก
   1. หรือเปลี่ยนรูปแบบพาร์ติชัน
   1. เลือก **ปิด** เพื่อบันทึกและปิดแผง

1. เลือกจำนวน **แอตทริบิวต์** สำหรับแต่ละเอนทิตีที่รวมไว้ หน้า **จัดการแอตทริบิวต์** จะแสดง

   :::image type="content" source="media/dataprofiling-entities.png" alt-text="กล่องโต้ตอบเพื่อเลือกการทำโปรไฟล์ข้อมูล":::

   1. สร้างแอตทริบิวต์ใหม่ แก้ไข หรือลบแอตทริบิวต์ที่มีอยู่ คุณสามารถเปลี่ยนชื่อ รูปแบบข้อมูล หรือเพิ่มชนิดความหมายได้
   1. หากต้องการเปิดใช้งานการวิเคราะห์และความสามารถอื่นๆ ให้เลือก **การทำโปรไฟล์ข้อมูล** สำหรับเอนทิตีทั้งหมดหรือสำหรับแอตทริบิวต์เฉพาะ โดยค่าเริ่มต้น ไม่มีการเปิดใช้งานเอนทิตีสำหรับการทำโปรไฟล์ข้อมูล
   1. เลือก **เสร็จ**

1. เลือก **บันทึก** หน้า **แหล่งข้อมูล** จะเปิดขึ้นเพื่อแสดงแหล่งข้อมูลใหม่ในสถานะ **กำลังรีเฟรช**

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

การโหลดข้อมูลอาจต้องใช้เวลา หลังจากการรีเฟรชที่สำเร็จ จะสามารถตรวจสอบข้อมูลที่ถูกนำไปใช้ได้จากหน้า [**เอนทิตี**](entities.md)

### <a name="create-a-new-schema-file"></a>สร้างไฟล์ Schema ใหม่

1. เลือก **ไฟล์ Schema ใหม่**

1. ป้อนชื่อสำหรับไฟล์แล้วเลือก **บันทึก**

1. เลือก **เอนทิตีใหม่** แผง **เอนทิตีใหม่** จะแสดง

1. ป้อนชื่อเอนทิตีและเลือก **ตำแหน่งไฟล์ข้อมูล**
   - **ไฟล์ .csv หรือ .parquet หลายไฟล์**: เรียกดูโฟลเดอร์ราก เลือกชนิดรูปแบบ และป้อนนิพจน์
   - **ไฟล์ .csv หรือ .parquet ไฟล์เดียว**: เรียกดูไฟล์ .csv หรือ .parquet แล้วเลือก

   :::image type="content" source="media/ADLS_new_entity_location.png" alt-text="กล่องโต้ตอบเพื่อสร้างเอนทิตีใหม่ที่เน้นตำแหน่งไฟล์ข้อมูล":::

1. เลือก **บันทึก**

   :::image type="content" source="media/ADLS_new_entity_define_attributes.png" alt-text="กล่องโต้ตอบเพื่อกำหนดหรือสร้างแอตทริบิวต์โดยอัตโนมัติ":::

1. เลือก **กำหนดแอตทริบิวต์** เพื่อเพิ่มแอตทริบิวต์ด้วยตนเอง หรือเลือก **สร้างแอตทริบิวต์โดยอัตโนมัติ** ในการกำหนดแอตทริบิวต์ ให้ป้อนชื่อ เลือกรูปแบบข้อมูลและชนิดความหมายเพิ่มเติม สำหรับแอตทริบิวต์ที่โดยอัตโนมัติ:

   1. หลังจากสร้างแอตทริบิวต์โดยอัตโนมัติแล้ว ให้เลือก **ตรวจสอบแอตทริบิวต์** หน้า **จัดการแอตทริบิวต์** จะแสดง

   1. ตรวจสอบให้แน่ใจว่ารูปแบบข้อมูลถูกต้องสำหรับแต่ละแอตทริบิวต์

   1. หากต้องการเปิดใช้งานการวิเคราะห์และความสามารถอื่นๆ ให้เลือก **การทำโปรไฟล์ข้อมูล** สำหรับเอนทิตีทั้งหมดหรือสำหรับแอตทริบิวต์เฉพาะ โดยค่าเริ่มต้น ไม่มีการเปิดใช้งานเอนทิตีสำหรับการทำโปรไฟล์ข้อมูล

      :::image type="content" source="media/dataprofiling-entities.png" alt-text="กล่องโต้ตอบเพื่อเลือกการทำโปรไฟล์ข้อมูล":::

   1. เลือก **เสร็จ** หน้า **เลือกเอนทิตี** จะปรากฏขึ้น

1. ดำเนินการต่อเพื่อเพิ่มเอนทิตีและแอตทริบิวต์ หากมี

1. หลังจากเพิ่มเอนทิตีทั้งหมดแล้ว ให้เลือก **รวม** เพื่อรวมเอนทิตีในการนำเข้าแหล่งข้อมูล

   :::image type="content" source="media/ADLS_required.png" alt-text="กล่องโต้ตอบที่แสดง ต้องการสำหรับคีย์หลัก":::

1. สำหรับเอนทิตีที่เลือกซึ่งต้องมีการนำเข้าแบบเพิ่มหน่วย **จำเป็น** จะแสดงภายใต้ **การรีเฟรชแบบเพิ่มหน่วย** สำหรับแต่ละเอนทิตีเหล่านี้ ดูที่ [กำหนดค่าการรีเฟรชแบบเพิ่มหน่วยสำหรับแหล่งข้อมูล Azure Data Lake](incremental-refresh-data-sources.md)

1. สำหรับเอนทิตีที่เลือกซึ่งไม่ได้กำหนดคีย์หลัก **จำเป็น** จะแสดงภายใต้ **คีย์หลัก** สำหรับแต่ละเอนทิตีเหล่านี้:
   1. เลือก **จำเป็น** แผง **แก้ไขเอนทิตี** จะแสดง
   1. เลือก **คีย์หลัก** คีย์หลักคือแอตทริบิวต์ที่ไม่ซ้ำกับเอนทิตี เพื่อให้แอตทริบิวต์เป็นคีย์หลักที่ถูกต้อง ไม่ควรมีค่าที่ซ้ำกัน ค่าที่ขาดหายไป หรือค่า null แอตทริบิวต์ชนิดข้อมูลสตริง จำนวนเต็ม และ GUID ได้รับการสนับสนุนเป็นคีย์หลัก
   1. หรือเปลี่ยนรูปแบบพาร์ติชัน
   1. เลือก **ปิด** เพื่อบันทึกและปิดแผง

1. เลือก **บันทึก** หน้า **แหล่งข้อมูล** จะเปิดขึ้นเพื่อแสดงแหล่งข้อมูลใหม่ในสถานะ **กำลังรีเฟรช**

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

การโหลดข้อมูลอาจต้องใช้เวลา หลังจากการรีเฟรชที่สำเร็จ จะสามารถตรวจสอบข้อมูลที่ถูกนำไปใช้ได้จากหน้า [**เอนทิตี**](entities.md)

## <a name="edit-an-azure-data-lake-storage-data-source"></a>แก้ไขแหล่งข้อมูล Azure Data Lake Storage

คุณสามารถปรับปรุงตัวเลือก *เชื่อมต่อกับบัญชีที่เก็บข้อมูลโดยใช้* สำหรับข้อมูลเพิ่มเติม โปรดดู [เชื่อมต่อ Customer Insights กับบัญชี Azure Data Lake Storage รุ่น2 ด้วยบริการหลักของ Azure](connect-service-principal.md) ถ้าคุณต้องการเชื่อมต่อกับคอนเทนเนอร์อื่นจากบัญชีที่เก็บข้อมูลของคุณ หรือเปลี่ยนชื่อบัญชี [สร้างการเชื่อมต่อแหล่งข้อมูลใหม่](#connect-to-azure-data-lake-storage)

1. ไปที่ **ข้อมูล** > **แหล่งข้อมูล**

1. ข้างแหล่งข้อมูลที่คุณต้องการปรับปรุง ให้เลือก **แก้ไข**

   :::image type="content" source="media/data_sources_edit_ADLS.png" alt-text="กล่องโต้ตอบเพื่อแก้ไขแหล่งข้อมูล Azure Data Lake":::

1. เปลี่ยนแปลงข้อมูลใดๆ ต่อไปนี้:

   - **รายละเอียด**
   - **เชื่อมต่อที่เก็บข้อมูลของคุณโดยใช้** และข้อมูลการเชื่อมต่อ คุณไม่สามารถเปลี่ยนแปลงข้อมูล **คอนเทนเนอร์** เมื่อปรับปรุงการเชื่อมต่อ
      > [!NOTE]
      > ต้องกำหนดหนึ่งในบทบาทต่อไปนี้ให้กับบัญชีที่เก็บเก็บข้อมูลหรือคอนเทนเนอร์:
        > - ตัวอ่าน Storage Blob Data
        > - เจ้าของ Storage Blob Data
        > - ผู้สนับสนุน Storage Blob Data

   - **เปิดใช้งาน Private Link** หรือถ้าคุณต้องการนำเข้าข้อมูลจากบัญชีที่เก็บข้อมูลผ่าน Azure Private Link สำหรับข้อมูลเพิ่มเติม โปรดดู [Private Link](security-overview.md#set-up-an-azure-private-link)

1. เลือก **ถัดไป**
1. เปลี่ยนแปลงรายการต่อไปนี้:
   - ทางไปยังไฟล์ model.json หรือ manifest.json อื่นที่มีชุดเอนทิตีอื่นจากคอนเทนเนอร์
   - หากต้องการเพิ่มเอนทิตีเพิ่มเติมที่จะนำเข้า ให้เลือก **เอนทิตีใหม่**
   - หากต้องการลบเอนทิตีที่เลือกอยู่แล้วหากไม่มีการขึ้นต่อกัน ให้เลือกเอนทิตีและ **ลบ**
      > [!IMPORTANT]
      > หากมีการอ้างอิงในไฟล์ model.json หรือ manifest.json ที่มีอยู่และชุดของเอนทิตี คุณจะเห็นข้อความแสดงข้อผิดพลาดและไม่สามารถเลือกไฟล์ model.json หรือ manifest.json อื่นได้ ลบการอ้างอิงเหล่านั้นก่อนเปลี่ยนแปลงไฟล์ model.json หรือ manifest.json หรือสร้างแหล่งข้อมูลใหม่ด้วยไฟล์ model.json หรือ manifest.json ที่คุณต้องการใช้ เพื่อหลีกเลี่ยงการลบการอ้างอิง
   - หากต้องการเปลี่ยนตำแหน่งไฟล์ข้อมูลหรือคีย์หลัก ให้เลือก **แก้ไข**
   - หากต้องการเปลี่ยนข้อมูลการนำเข้าแบบเพิ่มหน่วย โปรดดูที่ [กำหนดค่าการรีเฟรชแบบเพิ่มหน่วยสำหรับแหล่งข้อมูล Azure Data Lake](incremental-refresh-data-sources.md)
   - เปลี่ยนชื่อเอนทิตีให้ตรงกับชื่อเอนทิตีในไฟล์ .json เท่านั้น

     > [!NOTE]
     > คงชื่อเอนทิตีใน Customer Insights ให้เหมือนกับชื่อเอนทิตีภายในไฟล์ model.json หรือ manifest.json เสมอหลังการนำเข้า Customer Insights จะตรวจสอบชื่อเอนทิตีทั้งหมดกับ model.json หรือ manifest.json ในระหว่างการรีเฟรชระบบทุกครั้ง หากเปลี่ยนชื่อเอนทิตีภายใน Customer Insights หรือภายนอก จะเกิดข้อผิดพลาดขึ้นเนื่องจาก Customer Insights ไม่พบชื่อเอนทิตีใหม่ในไฟล์ .json หากมีการเปลี่ยนชื่อเอนทิตีที่นำเข้าโดยไม่ได้ตั้งใจ ให้แก้ไขชื่อเอนทิตีใน Customer Insights เพื่อให้ตรงกับชื่อในไฟล์ .json

1. เลือก **แอตทริบิวต์** เพื่อเพิ่มหรือเปลี่ยนแอตทริบิวต์ หรือเพื่อเปิดใช้งานการทำโปรไฟล์ข้อมูล จากนั้นเลือก **เสร็จสิ้น**

1. คลิก **บันทึก** เพื่อใช้การเปลี่ยนแปลงของคุณและกลับไปที่หน้า **แหล่งข้อมูล**

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

## <a name="common-reasons-for-ingestion-errors-or-corrupt-data"></a>สาเหตุทั่วไปของข้อผิดพลาดในการนำเข้าหรือข้อมูลที่เสียหาย

ระหว่างการนำเข้าข้อมูล สาเหตุทั่วไปบางประการที่เรกคอร์ดอาจถูกพิจารณาว่าเสียหาย ได้แก่:

- ชนิดข้อมูลและค่าของฟิลด์ไม่ตรงกันระหว่างไฟล์ต้นฉบับและสคีมา
- จำนวนคอลัมน์ในไฟล์ต้นฉบับไม่ตรงกับสคีมา
- ฟิลด์มีอักขระที่ทำให้คอลัมน์ผิดพลาดเมื่อเทียบกับสคีมาที่คาดไว้ ตัวอย่างเช่น: เครื่องหมายคำพูดที่มีรูปแบบไม่ถูกต้อง เครื่องหมายคำพูดที่ไม่ใช้ Escape อักขระขึ้นบรรทัดใหม่ หรืออักขระแท็บ
- ไฟล์พาร์ติชั่นหายไป
- หากมีคอลัมน์ datetime/date/datetimeoffset จะต้องระบุรูปแบบในสคีมาหากไม่เป็นไปตามรูปแบบมาตรฐาน

### <a name="schema-or-data-type-mismatch"></a>สคีมาหรือชนิดข้อมูลไม่ตรงกัน

หากข้อมูลไม่เป็นไปตามสคีมา กระบวนการนำเข้าจะเสร็จสมบูรณ์โดยมีข้อผิดพลาด แก้ไขแหล่งข้อมูลหรือสคีมาและนำเข้าข้อมูลอีกครั้ง

### <a name="partition-files-are-missing"></a>ไฟล์พาร์ติชั่นหายไป

- หากการนำเข้าสำเร็จโดยไม่มีเรกคอร์ดที่เสียหาย แต่คุณไม่เห็นข้อมูลใดๆ ให้แก้ไขไฟล์ model.json หรือ manifest.json เพื่อให้แน่ใจว่ามีการระบุพาร์ติชัน จากนั้น [รีเฟรชแหล่งข้อมูล](data-sources.md#refresh-data-sources)

- หากการนำเข้าข้อมูลเกิดขึ้นพร้อมกับการรีเฟรชแหล่งข้อมูลในระหว่างการรีเฟรชกำหนดการอัตโนมัติ ไฟล์พาร์ติชันอาจว่างเปล่าหรือไม่พร้อมใช้งานสำหรับ Customer Insights ในการประมวลผล เพื่อให้สอดคล้องกับกำหนดการรีเฟรชขั้นต้น ให้เปลี่ยน [กำหนดการรีเฟรชระบบ](schedule-refresh.md) หรือกำหนดการรีเฟรชสำหรับแหล่งข้อมูล ปรับเวลาให้ตรงกันเพื่อไม่ให้การรีเฟรชทั้งหมดเกิดขึ้นพร้อมกัน และให้ข้อมูลล่าสุดที่จะประมวลผลใน Customer Insights

### <a name="datetime-fields-in-the-wrong-format"></a>ฟิลด์วันที่เวลาอยู่ในรูปแบบที่ไม่ถูกต้อง

ฟิลด์วันที่และเวลาในเอนทิตีไม่อยู่ในรูปแบบ ISO 8601 หรือ en-US รูปแบบวันที่และเวลาเริ่มต้นใน Customer Insights คือรูปแบบ en-US ฟิลด์วันที่และเวลาทั้งหมดในเอนทิตีควรอยู่ในรูปแบบเดียวกัน Customer Insights รองรับรูปแบบอื่นๆ ที่ให้คำอธิบายประกอบหรือคุณลักษณะที่ระดับแหล่งที่มาหรือเอนทิตีในโมเดลหรือ manifest.json ตัวอย่างเช่น

**Model.json**

   ```json
      "annotations": [
        {
          "name": "ci:CustomTimestampFormat",
          "value": "yyyy-MM-dd'T'HH:mm:ss:SSS"
        },
        {
          "name": "ci:CustomDateFormat",
          "value": "yyyy-MM-dd"
        }
      ]   
   ```

  ใน manifest.json สามารถระบุรูปแบบวันที่และเวลาได้ที่ระดับเอนทิตีหรือที่ระดับแอตทริบิวต์ ที่ระดับเอนทิตี ใช้ "exhibitsTraits" ในเอนทิตีใน *.manifest.cdm.json เพื่อกำหนดรูปแบบวันที่และเวลา ที่ระดับแอตทริบิวต์ ใช้ "appliedTraits" ในแอตทริบิวต์ใน entityname.cdm.json

**Manifest.json ที่ระดับเอนทิตี**

```json
"exhibitsTraits": [
    {
        "traitReference": "is.formatted.dateTime",
        "arguments": [
            {
                "name": "format",
                "value": "yyyy-MM-dd'T'HH:mm:ss"
            }
        ]
    },
    {
        "traitReference": "is.formatted.date",
        "arguments": [
            {
                "name": "format",
                "value": "yyyy-MM-dd"
            }
        ]
    }
]
```

**Entity.json ที่ระดับแอตทริบิวต์**

```json
   {
      "name": "PurchasedOn",
      "appliedTraits": [
        {
          "traitReference": "is.formatted.date",
          "arguments" : [
            {
              "name": "format",
              "value": "yyyy-MM-dd"
            }
          ]
        },
        {
          "traitReference": "is.formatted.dateTime",
          "arguments" : [
            {
              "name": "format",
              "value": "yyyy-MM-ddTHH:mm:ss"
            }
          ]
        }
      ],
      "attributeContext": "POSPurchases/attributeContext/POSPurchases/PurchasedOn",
      "dataFormat": "DateTime"
    }
```

[!INCLUDE [footer-include](includes/footer-banner.md)]
