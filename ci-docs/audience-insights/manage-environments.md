---
title: สร้างและจัดการสภาพแวดล้อม
description: เรียนรู้วิธีการลงทะเบียนสำหรับบริการและวิธีจัดการสภาพแวดล้อม
ms.date: 03/28/2022
ms.subservice: audience-insights
ms.topic: how-to
ms.reviewer: mhart
author: adkuppa
ms.author: adkuppa
manager: shellyha
searchScope:
- ci-system-about
- customerInsights
ms.openlocfilehash: ba29bcd173e615e544bd10e69043f310c009eb47
ms.sourcegitcommit: ae02ac950810242e2505d7d371b80210dc8a0777
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/29/2022
ms.locfileid: "8492027"
---
# <a name="manage-environments"></a>จัดการสภาพแวดล้อม

## <a name="switch-environments"></a>สลับสภาพแวดล้อม

เลือกตัวควบคุม **สภาพแวดล้อม** ที่มุมบนขวาของหน้าเพื่อเปลี่ยนสภาพแวดล้อม

:::image type="content" source="media/home-page-environment-switcher.png" alt-text="ภาพหน้าจอของตัวควบคุมเพื่อสลับสภาพแวดล้อม":::

ผู้ดูแลระบบสามารถ [สร้าง](create-environment.md) และจัดการสภาพแวดล้อม

## <a name="edit-an-existing-environment"></a>แก้ไขสภาพแวดล้อมที่มีอยู่

คุณสามารถแก้ไขรายละเอียดบางส่วนของสภาพแวดล้อมที่มีอยู่

1.  เลือกตัวเลือก **สภาพแวดล้อม** ในส่วนหัวของแอป

2.  เลือกไอคอน **แก้ไข**

3. ในกล่อง **แก้ไขสภาพแวดล้อม** คุณสามารถปรับปรุงการตั้งค่าสภาพแวดล้อม

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับการตั้งค่าสภาพแวดล้อม โปรดดู [สร้างสภาพแวดล้อมใหม่](create-environment.md)

## <a name="connect-to-microsoft-dataverse"></a>เชื่อมต่อกับ Microsoft Dataverse
   
ขั้นตอน **Microsoft Dataverse** ช่วยให้คุณเชื่อมต่อ Customer Insights กับสภาพแวดล้อม Dataverse 

เตรียมสภาพแวดล้อม Microsoft Dataverse ของคุณเองเพื่อแชร์ข้อมูล (โปรไฟล์และข้อมูลเชิงลึก) กับแอปพลิเคชันทางธุรกิจที่อยู่บน Dataverse เช่น Dynamics 365 Marketing หรือแอปพลิเคชันแบบจำลองใน Power Apps

หากต้องการใช้ [แบบจำลองการคาดคะเนสำเร็จรูป](predictions-overview.md#out-of-box-models) ให้กำหนดค่าการแบ่งปันข้อมูลด้วย Dataverse หรือคุณสามารถเปิดใช้งานการเพิ่มข้อมูลเข้าระบบจากแหล่งข้อมูลในองค์กร โดยให้ URL สภาพแวดล้อม Microsoft Dataverse ที่องค์กรของคุณดูแล

การเปิดใช้งานการแชร์ข้อมูลกับ Microsoft Dataverse โดยการเลือกกล่องกาเครื่องหมายการแชร์ข้อมูลจะทริกเกอร์การรีเฟรชแหล่งข้อมูลของคุณและกระบวนการอื่นๆ ทั้งหมดหนึ่งครั้ง

> [!IMPORTANT]
> 1. Customer Insights และ Dataverse ต้องอยู่ในภูมิภาคเดียวกันจึงจะสามารถแชร์ข้อมูลได้
> 1. คุณต้องมีบทบาทผู้ดูแลระบบส่วนกลางในสภาพแวดล้อม Dataverse ตรวจสอบว่า [สภาพแวดล้อม Dataverse นี้เชื่อมโยง](/power-platform/admin/control-user-access#associate-a-security-group-with-a-dataverse-environment) กับกลุ่มความปลอดภัยที่กำหนดหรือไม่และตรวจสอบว่าคุณได้เพิ่มสภาพแวดล้อมลงในกลุ่มความปลอดภัยเหล่านั้นแล้ว
> 1. ไม่มีสภาพแวดล้อม Customer Insights ที่มีอยู่เชื่อมโยงกับสภาพแวดล้อม Dataverse นั้น เรียนรู้วิธีการ [ลบการเชื่อมต่อกับสภาพแวดล้อม Dataverse ที่มีอยู่](#remove-an-existing-connection-to-a-dataverse-environment)

:::image type="content" source="media/dataverse-enable-datasharing.png" alt-text="ตัวเลือกการกำหนดค่าเพื่อเปิดใช้งานการแบ่งปันข้อมูลกับ Microsoft Dataverse":::

### <a name="enable-data-sharing-with-dataverse-from-your-own-azure-data-lake-storage-preview"></a>เปิดใช้งานการแชร์ข้อมูลกับ Dataverse จาก Azure Data Lake Storage ของคุณเอง (พรีวิว)

หากสภาพแวดล้อมของคุณได้รับการกำหนดค่าให้ใช้ Azure Data Lake Storage ของคุณเองเพื่อจัดเก็บข้อมูล Customer Insights การเปิดใช้งานการแชร์ข้อมูลกับ Microsoft Dataverse ต้องการการกำหนดค่าพิเศษบางอย่าง

1. สร้างกลุ่มความปลอดภัยสองกลุ่มในการสมัครใช้งาน Azure ของคุณ กลุ่มหนึ่งคือ กลุ่มความปลอดภัย **ผู้อ่าน** และอีกกลุ่มคือ **ผู้มีส่วนร่วม** และตั้งค่าบริการ Microsoft Dataverse ในฐานะเจ้าของกลุ่มความปลอดภัยทั้งสองกลุ่ม
2. จัดการรายการตัวควบคุมการเข้าถึง (ACL) บนคอนเทนเนอร์ CustomerInsights ในบัญชีที่เก็บข้อมูลของคุณผ่านกลุ่มความปลอดภัยเหล่านี้ เพิ่มบริการ Microsoft Dataverse และแอปพลิเคชันทางธุรกิจบน Dataverse  ใดๆ เช่น Dynamics 365 Marketing ไปยังกลุ่มความปลอดภัย **ผู้อ่าน** ด้วยสิทธิ์การใช้งาน **อ่านอย่างเดียว** เพิ่ม *เฉพาะ* แอปพลิเคชัน Customers Insights ไปยังกลุ่มความปลอดภัย **ผู้มีส่วนร่วม** เพื่อให้ทั้งสิทธิ์การใช้งาน **อ่านและเขียน** ในการเขียนโปรไฟล์และข้อมูลเชิงลึก
   
#### <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

ในการเรียกใช้สคริปต์ PowerShell คุณต้องนำเข้าสามโมดูลต่อไปนี้ 

1. ติดตั้งเวอร์ชันล่าสุดของ [Azure Active Directory PowerShell for Graph](/powershell/azure/active-directory/install-adv2).
   1. บนพีซีของคุณ เลือกคีย์ Windows บนแป้นพิมพ์ และค้นหา **Windows PowerShell** และเลือก **เรียกใช้เป็นผู้ดูแลระบบ**
   1. ในหน้าต่าง PowerShell ที่เปิดขึ้น ให้ป้อน `Install-Module AzureAD`
2. นำเข้าสามโมดูล
    1. ในหน้าต่าง PowerShell ให้ป้อน `Install-Module -Name Az.Accounts` และปฏิบัติตามขั้นตอน 
    1. ทำซ้ำสำหรับ `Install-Module -Name Az.Resources` และ `Install-Module -Name Az.Storage`

#### <a name="configuration-steps"></a>กำหนดค่าขั้นตอน

1. ดาวน์โหลดสคริปต์ PowerShell สองชุดที่คุณต้องเรียกใช้จาก [GitHub repo](https://github.com/trin-msft/byol) ของวิศวกรของเรา
    1. `CreateSecurityGroups.ps1`
       - คุณต้องมีสิทธิ์ *ผู้ดูแลระบบผู้เช่า* เพื่อเรียกใช้สคริปต์ PowerShell นี้ 
       - สคริปต์ PowerShell นี้สร้างกลุ่มความปลอดภัยสองกลุ่มในการสมัครใช้งาน Azure ของคุณ กลุ่มหนึ่งเป็นกลุ่มผู้อ่าน และอีกกลุ่มเป็นกลุ่ม ผู้มีส่วนร่วม และจะทำให้บริการ Microsoft Dataverse เป็นเจ้าของกลุ่มความปลอดภัยทั้งสองกลุ่มนี้
       - เรียกใช้สคริปต์ PowerShell นี้ใน Windows PowerShell โดยระบุรหัสการสมัครใช้งาน Azure ที่มี Azure Data Lake Storage ของคุณ เปิดสคริปต์ PowerShell ในตัวแก้ไขเพื่อตรวจสอบข้อมูลเพิ่มเติมและตรรกะที่นำไปใช้
       - บันทึกค่ารหัสกลุ่มความปลอดภัยที่สร้างโดยสคริปต์นี้ เพราะเราจะใช้ในสคริปต์ `ByolSetup.ps1`
       
        > [!NOTE]
        > การสร้างกลุ่มความปลอดภัยสามารถปิดใช้งานได้ในผู้เช่าของคุณ ในกรณีนั้น จำเป็นต้องมีการตั้งค่าด้วยตนเองและผู้ดูแลระบบ Azure AD ของคุณจะต้อง [เปิดใช้งานการสร้างกลุ่มความปลอดภัย](/azure/active-directory/enterprise-users/groups-self-service-management)

    2. `ByolSetup.ps1`
        - คุณต้องการสิทธิ์ *เจ้าของข้อมูลในที่เก็บข้อมูล Blob* ที่ระดับบัญชีที่จัดเก็บข้อมูล/คอนเทนเนอร์เพื่อเรียกใช้สคริปต์นี้ มิฉะนั้นสคริปต์นี้จะสร้างให้คุณ การกำหนดบทบาทของคุณสามารถเอาออกได้ด้วยตนเองหลังจากเรียกใช้สคริปต์สำเร็จ
        - สคริปต์ PowerShell นี้เพิ่มการควบคุมการเข้าถึงตามบทบาท (RBAC) ที่จำเป็นสำหรับบริการ Microsoft Dataverse และแอปพลิเคชันทางธุรกิจบน Dataverse นอกจากนี้ยังมีการปรับปรุงรายการตัวควบคุมการเข้าถึง (ACL) บนคอนเทนเนอร์ Customer Insights สำหรับกลุ่มความปลอดภัยที่สร้างด้วยสคริปต์ `CreateSecurityGroups.ps1` กลุ่มผู้มีส่วนร่วมจะมีสิทธิ์ *rwx* และกลุ่มผู้อ่านจะมีเฉพาะสิทธิ์ *r-x* เท่านั้น
        - เรียกใช้สคริปต์ PowerShell นี้ใน Windows PowerShell โดยระบุรหัสการสมัครใช้งาน Azure ที่มี Azure Data Lake Storage, ชื่อบัญชีที่เก็บข้อมูล ชื่อกลุ่มทรัพยากร และค่ารหัสกลุ่มความปลอดภัย ผู้อ่าน และผู้มีส่วนร่วมของคุณ เปิดสคริปต์ PowerShell ในตัวแก้ไขเพื่อตรวจสอบข้อมูลเพิ่มเติมและตรรกะที่นำไปใช้
        - คัดลอกสตริงเอาต์พุตหลังจากเรียกใช้สคริปต์สำเร็จ สตริงเอาต์พุตมีลักษณะดังนี้: `https: //DVBYODLDemo/customerinsights?rg=285f5727-a2ae-4afd-9549-64343a0gbabc&cg=720d2dae-4ac8-59f8-9e96-2fa675dbdabc`
        
2. ป้อนสตริงเอาต์พุตที่คัดลอกจากด้านบนลงในฟิลด์ **ตัวระบุสิทธิ์** ของขั้นตอนการกำหนดค่าสภาพแวดล้อมสำหรับ Microsoft Dataverse

:::image type="content" source="media/dataverse-enable-datasharing-BYODL.png" alt-text="ตัวเลือกการกำหนดค่าเพื่อเปิดใช้งานการแชร์ข้อมูลจาก Azure Data Lake Storage ของคุณเองกับ Microsoft Dataverse":::

Customer Insights ไม่สนับสนุนสถานการณ์การแบ่งปันข้อมูลต่อไปนี้:
- หากคุณเปิดใช้งานการแบ่งปันข้อมูลด้วยที่จัดเก็บข้อมูลดิบที่จัดการ Dataverse คุณจะไม่สามารถ [สร้างค่าที่คาดคะเนหรือขาดหายไปในเอนทิตี](predictions.md)
- หากคุณเปิดใช้งานการแชร์ข้อมูลกับ Dataverse คุณจะไม่สามารถดูรายงาน PowerBI Embedded ที่เป็นตัวเลือกในสภาพแวดล้อม Customer Insights ของคุณได้

### <a name="remove-an-existing-connection-to-a-dataverse-environment"></a>ลบการเชื่อมต่อกับสภาพแวดล้อม Dataverse ที่มีอยู่

เมื่อเชื่อมต่อกับสภาพแวดล้อม Dataverse ข้อความแสดงข้อผิดพลาด **องค์กร CDS นี้แนบกับอินสแตนซ์ Customer Insights อื่นอยู่แล้ว** หมายความว่าสภาพแวดล้อม Dataverse มีการใช้อยู่แล้วในสภาพแวดล้อม Customer Insights คุณสามารถลบการเชื่อมต่อที่มีอยู่ในสภาพแวดล้อม Dataverse ในฐานะผู้ดูแลระบบส่วนกลาง โดยอาจใช้เวลาสองสามชั่วโมงในการเติมข้อมูลการเปลี่ยนแปลง

1. ไปที่ [Power Apps](https://make.powerapps.com)
1. เลือกสภาพแวดล้อมจากตัวเลือกสภาพแวดล้อม
1. ไปที่ **โซลูชัน**
1. ถอนการติดตั้งหรือลบโซลูชันที่ชื่อ **Add-in การ์ดลูกค้าของ Dynamics 365 Customer Insights (พรีวิว)**

OR 

1. เปิดสภาพแวดล้อม Dataverse ของคุณ
1. ไปที่ **การตั้งค่าขั้นสูง** > **โซลูชัน**
1. ถอนการติดตั้งโซลูชัน **CustomerInsightsCustomerCard**

## <a name="copy-the-environment-configuration"></a>คัดลอกการกำหนดค่าของสภาพแวดล้อม

ในฐานะผู้ดูแลระบบ คุณสามารถเลือกคัดลอกการกำหนดค่าจากสภาพแวดล้อมที่มีอยู่เมื่อคุณสร้างใหม่ 

:::image type="content" source="media/environment-settings-dialog.png" alt-text="ภาพหน้าจอของตัวเลือกการตั้งค่าในการตั้งค่าสภาพแวดล้อม":::

คุณจะเห็นรายการของสภาพแวดล้อมที่พร้อมใช้งานทั้งหมดในองค์กรของคุณ ที่ซึ่งคุณสามารถคัดลอกข้อมูลได้

การตั้งค่าการกำหนดค่าต่อไปนี้จะถูกคัดลอก:

- แหล่งข้อมูลที่ รับเข้า/นำเข้า
- การกำหนดค่าการรวมข้อมูล (แมป จับคู่ ผสาน)
- เซ็กเมนต์
- การวัด
- ความสัมพันธ์
- กิจกรรม
- ดัชนีการค้นหาและตัวกรอง
- ปลายทางการส่งออก
- การรีเฟรชที่มีการจัดกำหนดการ
- การเพิ่มคุณค่า
- การจัดการโมเดล
- การกำหนดบทบาท

## <a name="set-up-a-copied-environment"></a>ตั้งค่าสภาพแวดล้อมที่คัดลอก

เมื่อคุณคัดลอกการกำหนดค่าสภาพแวดล้อม ข้อมูลต่อไปนี้จะ *ไม่* ถูกคัดลอก:

- โปรไฟล์ลูกค้า
- ข้อมูลประจำตัวของแหล่งข้อมูล คุณจะต้องให้ข้อมูลประจำตัวสำหรับทุกแหล่งข้อมูล และรีเฟรชแหล่งข้อมูลด้วยตนเอง
- แหล่งข้อมูลจากโฟลเดอร์ Common Data Model และที่จัดเก็บข้อมูลดิบที่มีการจัดการของ Dataverse คุณจะต้องสร้างแหล่งข้อมูลเหล่านั้นด้วยตนเองด้วยชื่อเดียวกันกับในสภาพแวดล้อมของแหล่งที่มา
- ข้อมูลความลับของการเชื่อมต่อที่ใช้สำหรับการส่งออกและการเพิ่มข้อมูล คุณต้องรับรองความถูกต้องของการเชื่อมต่ออีกครั้ง จากนั้นเปิดใช้งานการเพิ่มข้อมูลและส่งออกอีกครั้ง 

เมื่อคุณคัดลอกสภาพแวดล้อม คุณจะเห็นข้อความยืนยันว่าสภาพแวดล้อมใหม่ถูกสร้างขึ้น เลือก **ไปที่แหล่งข้อมูล** เพื่อดูรายการแหล่งข้อมูล

แหล่งข้อมูลทั้งหมดจะแสดงสถานะ **ต้องการข้อมูลประจำตัว** แก้ไขแหล่งข้อมูล และป้อนข้อมูลประจำตัวเพื่อรีเฟรช

:::image type="content" source="media/data-sources-copied.png" alt-text="รายการของแหล่งข้อมูลที่ถูกคัดลอกและต้องมีการรับรองความถูกต้อง":::

หลังจากที่รีเฟรชแหล่งข้อมูล ให้ไปที่ **ข้อมูล** > **รวม** ที่นี่คุณจะพบการตั้งค่าจากสภาพแวดล้อมของแหล่งที่มา แก้ไขได้ตามต้องการ หรือเลือก **เรียกใช้** เพื่อเริ่มกระบวนการรวมข้อมูล และสร้างเอนทิตีลูกค้าแบบรวม

เมื่อการรวมข้อมูลเสร็จสมบูรณ์ ให้ไปที่ **การวัด** และ **เซ็กเมนต์** เพื่อรีเฟรชพวกเขาด้วย

ก่อนที่คุณจะเปิดใช้งานการส่งออกและการเพิ่มข้อมูลอีกครั้ง ให้ไปที่ **ผู้ดูแลระบบ** > **การเชื่อมต่อ** เพื่อรับรองความถูกต้องของการเชื่อมต่ออีกครั้งในสภาพแวดล้อมใหม่ของคุณ

## <a name="change-the-owner-of-an-environment"></a>เปลี่ยนเจ้าของสภาพแวดล้อม

แม้ว่าผู้ใช้หลายรายสามารถมีสิทธิ์ของผู้ดูแลระบบใน Customer Insights ได้ แต่มีผู้ใช้เพียงคนเดียวเท่านั้นที่เป็นเจ้าของสภาพแวดล้อม โดยค่าเริ่มต้น ผู้ดูแลระบบจะเป็นผู้สร้างสภาพแวดล้อมในครั้งแรก ในฐานะผู้ดูแลระบบสภาพแวดล้อม คุณสามารถกำหนดความเป็นเจ้าของให้กับผู้ใช้รายอื่นที่มีสิทธิ์ของผู้ดูแลระบบได้

1. เลือกตัวเลือก **สภาพแวดล้อม** ในส่วนหัวของแอป

1. เลือกไอคอน **แก้ไข**

1. ในกล่อง **แก้ไขสภาพแวดล้อม** ไปที่ขั้นตอน **ข้อมูลพื้นฐาน**

1. ในฟิลด์ **เปลี่ยนเจ้าของสภาพแวดล้อม** เลือกเจ้าของใหม่ให้กับสภาพแวดล้อม  

1. เลือก **ตรวจทานและเสร็จสิ้น** จากนั้นเลือก **ปรับปรุง** เพื่อใช้การเปลี่ยนแปลง 

## <a name="claim-ownership-of-an-environment"></a>อ้างสิทธิ์ความเป็นเจ้าของสภาพแวดล้อม

ถ้าเจ้าของสภาพแวดล้อมออกจากองค์กรหรือบัญชีผู้ใช้ถูกลบ สภาพแวดล้อมจะไม่มีเจ้าของ ผู้ใช้ที่มีสิทธิ์ของผู้ดูแลระบบสามารถอ้างสิทธิ์ความเป็นเจ้าของและกลายเป็นเจ้าของใหม่ได้ พวกเขาสามารถเป็นเจ้าของสภาพแวดล้อมต่อไปหรือ [เปลี่ยนความเป็นเจ้าของไปยังผู้ดูแลระบบรายอื่น](#change-the-owner-of-an-environment) 

หากต้องการอ้างสิทธิ์ความเป็นเจ้าของ ให้เลือกปุ่ม **เข้าเป็นเจ้าของ** ที่แสดงด้านบนของทุกเพจใน Customer Insights เมื่อเจ้าของเดิมออกจากองค์กร

## <a name="reset-an-existing-environment"></a>รีเซ็ตสภาพแวดล้อมที่มีอยู่

ในฐานะเจ้าของสภาพแวดล้อม คุณสามารถรีเซ็ตสภาพแวดล้อมให้เป็นสถานะว่างเปล่าได้หากคุณต้องการลบการกำหนดค่าทั้งหมดและลบข้อมูลที่นำเข้า

1.  เลือกตัวเลือก **สภาพแวดล้อม** ในส่วนหัวของแอป 

2.  เลือกสภาพแวดล้อมที่คุณต้องการรีเซ็ต และเลือกจุดไข่ปลา (**...**) 

3. เลือกตัวเลือก **รีเซ็ต** 

4.  การยืนยันการลบ ให้ป้อนชื่อสภาพแวดล้อมและเลือก **รีเซ็ต**

## <a name="delete-an-existing-environment"></a>ลบสภาพแวดล้อมที่มีอยู่

ในฐานะเจ้าของสภาพแวดล้อม คุณสามารถลบสภาพแวดล้อมที่คุณดูแลได้

1.  เลือกตัวเลือก **สภาพแวดล้อม** ในส่วนหัวของแอป

2.  เลือกสภาพแวดล้อมที่คุณต้องการรีเซ็ต และเลือกจุดไข่ปลา (**...**) 

3. เลือกตัวเลือก **ลบ** 

4.  หากต้องการยืนยันการลบ ให้ป้อนชื่อสภาพแวดล้อม และเลือก **ลบ**

> [!NOTE]
> การลบสภาพแวดล้อมไม่ได้ลบการเชื่อมโยงกับสภาพแวดล้อม Dataverse เรียนรู้วิธี [ลบการเชื่อมต่อกับสภาพแวดล้อม Dataverse ที่มีอยู่](#remove-an-existing-connection-to-a-dataverse-environment)


[!INCLUDE[footer-include](../includes/footer-banner.md)]
