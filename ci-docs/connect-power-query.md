---
title: เชื่อมต่อกับแหล่งข้อมูล Power Query (มีวิดีโอ)
description: นำเข้าข้อมูลผ่านตัวเชื่อมต่อ Power Query (มีวิดีโอ)
ms.date: 06/13/2022
ms.reviewer: v-wendysmith
ms.subservice: audience-insights
ms.topic: how-to
author: adkuppa
ms.author: matgos
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- customerInsights
ms.openlocfilehash: 6736b253e3a7e652f92f61bc44bfb31ca69be31a
ms.sourcegitcommit: dca46afb9e23ba87a0ff59a1776c1d139e209a32
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 06/29/2022
ms.locfileid: "9081762"
---
# <a name="connect-to-a-power-query-data-source"></a>เชื่อมต่อกับแหล่งข้อมูล Power Query

Power Query มีตัวเชื่อมต่อที่หลากหลายเพื่อนำเข้าข้อมูล ตัวเชื่อมต่อเหล่านี้ส่วนใหญ่รองรับโดย Dynamics 365 Customer Insights

การเพิ่มแหล่งข้อมูลตามตัวเชื่อมต่อ Power Query โดยทั่วไปจะทำตามขั้นตอนที่อธิบายไว้ในส่วนนี้ อย่างไรก็ตาม ขึ้นอยู่กับตัวเชื่อมต่อที่คุณใช้ ข้อมูลที่จำเป็นแตกต่างกัน หากต้องการเรียนรู้เพิ่มเติม โปรดดูคู่มือเกี่ยวกับตัวเชื่อมต่อแต่ละตัวใน [ข้อมูลอ้างอิงตัวเชื่อมต่อ Power Query](/power-query/connectors/)

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RWN6EK]

## <a name="create-a-new-data-source"></a>สร้างแหล่งข้อมูลใหม่

1. ไปที่ **ข้อมูล** > **แหล่งข้อมูล**

1. เลือก **เพิ่มแหล่งข้อมูล**

1. เลือก **Microsoft Power Query**

1. ระบุ **ชื่อ** และ **คำอธิบาย** ที่ระบุหรือไม่ก็ได้สำหรับแหล่งข้อมูล และเลือก **ถัดไป**

1. เลือกหนึ่งใน [ตัวเชื่อมต่อที่พร้อมใช้งาน](#available-power-query-data-sources) ในตัวอย่างนี้ เราเลือกตัวเชื่อมต่อ **Text/CSV**

1. ป้อนรายละเอียดที่จำเป็นใน **การตั้งค่าการเชื่อมต่อ** สำหรับตัวเชื่อมต่อที่เลือก และเลือก **ต่อไป** เพื่อดูตัวอย่างข้อมูล

1. เลือก **แปลงข้อมูล** ในขั้นตอนนี้ คุณจะเพิ่มเอนทิตีลงในแหล่งข้อมูลของคุณ เอนทิตีคือชุดข้อมูล ถ้าคุณมีฐานข้อมูลที่รวมชุดข้อมูลหลายชุด ชุดข้อมูลแต่ละชุดเป็นเอนทิตีของตนเอง

1. กล่องโต้ตอบ **Power Query - แก้ไขการสอบถาม** ช่วยให้คุณตรวจสอบและปรับแต่งข้อมูลได้ เอนทิตีที่ระบบระบุในแหล่งข้อมูลที่คุณเลือกจะปรากฏในบานหน้าต่างด้านซ้าย

   :::image type="content" source="media/data-manager-configure-edit-queries.png" alt-text="แก้ไขกล่องโต้ตอบการสอบถาม":::

1. นอกจากนี้ คุณยังสามารถแปลงข้อมูลของคุณได้ เลือกเอนทิตีที่จะแก้ไขหรือแปลง ใช้ตัวเลือกในหน้าต่าง Power Query เพื่อใช้การแปลงข้อมูล การเปลี่ยนแปลงแต่ละรายการอยู่ภายใต้ **ขั้นตอนที่ใช้** Power Query มีตัวเลือกการแปลงข้อมูลที่สร้างไว้ล่วงหน้าจำนวนมาก สำหรับข้อมูลเพิ่มเติม โปรดดูที่ [การแปลงข้อมูล Power Query](/power-query/power-query-what-is-power-query#transformations)

   เราขอแนะนำให้คุณใช้การแปลงข้อมูลต่อไปนี้:

   - หากคุณนำเข้าข้อมูลจากไฟล์ CSV แถวแรกมักมีส่วนหัว ไปที่ **แปลงข้อมูล** และเลือก **ใช้แถวแรกเป็นส่วนหัว**
   - ตรวจสอบให้แน่ใจว่าได้ตั้งค่าชนิดข้อมูลอย่างเหมาะสม ตัวอย่างเช่น สำหรับฟิลด์วันที่ ให้เลือกชนิดวันที่

1. หากต้องการเพิ่มเอนทิตีเพิ่มเติมในแหล่งข้อมูลของคุณในกล่องโต้ตอบ **แก้ไขการสอบถาม** ไปที่ **หน้าแรก** และเลือก **รับข้อมูล** ทำซ้ำขั้นตอนที่ 6-10 จนกระทั่งคุณเพิ่มเอนทิตีทั้งหมดสำหรับแหล่งข้อมูลนี้

1. เลือก **บันทึก** หน้า **แหล่งข้อมูล** จะเปิดขึ้นเพื่อแสดงแหล่งข้อมูลใหม่ในสถานะ **กำลังรีเฟรช**

### <a name="available-power-query-data-sources"></a>แหล่งข้อมูล Power Query ที่พร้อมใช้งาน

ดู [ข้อมูลอ้างอิงตัวเชื่อมต่อ Power Query](/power-query/connectors/) สำหรับรายการตัวเชื่อมต่อที่คุณสามารถใช้เพื่อนำเข้าข้อมูลไปยัง Customer Insights

ตัวเชื่อมต่อที่มีเครื่องหมายกาถูกในคอลัมน์ **Customer Insights (กระแสข้อมูล)** สามารถใช้ในการสร้างแหล่งข้อมูลใหม่ที่อิงตาม Power Query ได้ ตรวจสอบคู่มือของตัวเชื่อมต่อเฉพาะเพื่อเรียนรู้เพิ่มเติมเกี่ยวกับข้อกำหนดเบื้องต้น [ข้อจำกัดในการสอบถาม](/power-query/power-query-online-limits) และรายละเอียดอื่นๆ

## <a name="add-data-from-on-premises-data-sources"></a>เพิ่มข้อมูลจากแหล่งข้อมูลภายในองค์กร

รองรับการรับข้อมูลเข้าจากแหล่งข้อมูลในองค์กรตามกระแสข้อมูล Microsoft Power Platform (PPDF) คุณสามารถเปิดใช้งานกระแสข้อมูลใน Customer Insights โดย [การระบุ URL สภาพแวดล้อม Microsoft Dataverse](create-environment.md) เมื่อสร้างสภาพแวดล้อม

แหล่งข้อมูลที่สร้างขึ้นหลังจากเชื่อมโยงสภาพแวดล้อม Dataverse กับ Customer Insights จะใช้ [กระแสข้อมูล Power Platform](/power-query/dataflows/overview-dataflows-across-power-platform-dynamics-365) โดยค่าเริ่มต้น โฟลว์ข้อมูลสนับสนุนการเชื่อมต่อภายในองค์กรโดยใช้เกตเวย์ข้อมูล คุณสามารถลบและสร้างแหล่งข้อมูลที่มีอยู่ก่อนการเชื่อมโยงสภาพแวดล้อม Dataverse ขึ้นมาใหม่ได้ [โดยใช้เกตเวย์ข้อมูลภายในองค์กร](/data-integration/gateway/service-gateway-app)

เกตเวย์ข้อมูลจากสภาพแวดล้อม Power BI หรือ Power Apps จะมองเห็นและคุณสามารถใช้ซ้ำได้ใน Customer Insights หน้าแหล่งข้อมูลแสดงลิงก์เพื่อไปที่สภาพแวดล้อม Microsoft Power Platform ที่คุณสามารถดูและกำหนดค่าเกตเวย์ข้อมูลภายในองค์กร

> [!IMPORTANT]
> ตรวจสอบให้แน่ใจว่าเกตเวย์ของคุณได้รับการปรับปรุงให้เป็นเวอร์ชันล่าสุดแล้ว คุณสามารถติดตั้งการปรับปรุงและกำหนดค่าเกตเวย์ใหม่ได้จากข้อความแจ้งที่แสดงบนหน้าจอเกตเวย์โดยตรงหรือ [ดาวน์โหลดเวอร์ชันล่าสุด](https://powerapps.microsoft.com/downloads/) หากคุณไม่ได้ใช้เกตเวย์เวอร์ชันล่าสุด การรีเฟรชกระแสข้อมูลจะล้มเหลวโดยมีข้อความแสดงข้อผิดพลาด เช่น **ไม่รองรับคำสำคัญ: คุณสมบัติการกำหนดค่า ชื่อพารามิเตอร์: คำสำคัญ**

## <a name="edit-power-query-data-sources"></a>แก้ไขแหล่งข้อมูล Power Query

> [!NOTE]
> อาจไม่สามารถทำการเปลี่ยนแปลงแหล่งข้อมูลที่กำลังใช้งานอยู่ในหนึ่งในกระบวนการของแอปได้ (ตัวอย่างเช่น *การแบ่งเซ็กเมนต์* *การจับคู่* หรือ *การผสาน*)
>
> ในเพจ **การตั้งค่า** คุณสามารถติดตามความคืบหน้าของแต่ละกระบวนการที่ใช้งานอยู่ได้ เมื่อกระบวนการเสร็จสมบูรณ์ คุณสามารถกลับไปที่หน้า **แหล่งข้อมูล** และทำการเปลี่ยนแปลงของคุณได้

1. ไปที่ **ข้อมูล** > **แหล่งข้อมูล**

1. ข้างแหล่งข้อมูลที่คุณต้องการปรับปรุง ให้เลือก **แก้ไข**

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

1. ใช้การเปลี่ยนแปลงและการแปลงข้อมูลของคุณในกล่องโต้ตอบ **Power Query - แก้ไขการสอบถาม** ตามที่อธิบายไว้ในส่วน [สร้างแหล่งข้อมูลใหม่](#create-a-new-data-source)

1. เลือก **บันทึก** ใน Power Query หลังจากเสร็จสิ้นการแก้ไขของคุณเพื่อบันทึกการเปลี่ยนแปลง
